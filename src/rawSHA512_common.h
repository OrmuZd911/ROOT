/*
 * This file is part of John the Ripper password cracker,
 * Copyright (c) 2012 magnum
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted.
 *
 * There's ABSOLUTELY NO WARRANTY, express or implied.
 */

#ifndef _COMMON_RAWSHA512_H
#define _COMMON_RAWSHA512_H

/* ------ Contains (at least) prepare(), valid() and split() ------ */
#define BINARY_SIZE                     64
#define BINARY_ALIGN                    MEM_ALIGN_WORD

#define BENCHMARK_COMMENT               ""
#define BENCHMARK_LENGTH	        -1
#define XSHA512_BENCHMARK_LENGTH	0

#define FORMAT_TAG			"$SHA512$"
#define XSHA512_FORMAT_TAG              "$LION$"

#define TAG_LENGTH			(sizeof(FORMAT_TAG) - 1)
#define XSHA512_TAG_LENGTH              (sizeof(XSHA512_FORMAT_TAG) - 1)

#define CIPHERTEXT_LENGTH		128
#define XSHA512_CIPHERTEXT_LENGTH	136

int sha512_common_valid(char *ciphertext, struct fmt_main *self);
int sha512_common_valid_xsha(char *ciphertext, struct fmt_main *self);
void * sha512_common_binary(char *ciphertext);
void * sha512_common_binary_xsha(char *ciphertext);
char * sha512_common_prepare_xsha(char *split_fields[10], struct fmt_main *self);
char * sha512_common_split(char *ciphertext, int index, struct fmt_main *self);
char * sha512_common_split_xsha(char *ciphertext, int index, struct fmt_main *pFmt);

#ifdef __RAWSHA512_CREATE_PROPER_TESTS_ARRAY__
static struct fmt_tests sha512_common_tests[] = {
	{"f342aae82952db35b8e02c30115e3deed3d80fdfdadacab336f0ba51ac54e297291fa1d6b201d69a2bd77e2535280f17a54fa1e527abc6e2eddba79ad3be11c0", "epixoip"},
	{FORMAT_TAG "f342aae82952db35b8e02c30115e3deed3d80fdfdadacab336f0ba51ac54e297291fa1d6b201d69a2bd77e2535280f17a54fa1e527abc6e2eddba79ad3be11c0", "epixoip"},
	{"b109f3bbbc244eb82441917ed06d618b9008dd09b3befd1b5e07394c706a8bb980b1d7785e5976ec049b46df5f1326af5a2ea6d103fd07c95385ffab0cacbc86", "password"},
	{"2c80f4c2b3db6b677d328775be4d38c8d8cd9a4464c3b6273644fb148f855e3db51bc33b54f3f6fa1f5f52060509f0e4d350bb0c7f51947728303999c6eff446", "john-user"},
	{"71ebcb1eccd7ea22bd8cebaec735a43f1f7164d003dacdeb06e0de4a6d9f64d123b00a45227db815081b1008d1a1bbad4c39bde770a2c23308ff1b09418dd7ed", "ALLCAPS"},
	{"82244918c2e45fbaa00c7c7d52eb61f309a37e2f33ea1fba78e61b4140efa95731eec849de02ee16aa31c82848b51fb7b7fbae62f50df6e150a8a85e70fa740c", "TestTESTt3st"},
	{"fa585d89c851dd338a70dcf535aa2a92fee7836dd6aff1226583e88e0996293f16bc009c652826e0fc5c706695a03cddce372f139eff4d13959da6f1f5d3eabe", "12345678"},
	{FORMAT_TAG "fa585d89c851dd338a70dcf535aa2a92fee7836dd6aff1226583e88e0996293f16bc009c652826e0fc5c706695a03cddce372f139eff4d13959da6f1f5d3eabe", "12345678"},
	{FORMAT_TAG "cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e", ""},
	{"c96f1c1260074832bd3068ddd29e733090285dfc65939555dbbcafb27834957d15d9c509481cc7df0e2a7e21429783ba573036b78f5284f9928b5fef02a791ef", "mot\xf6rhead"},
	{"aa3b7bdd98ec44af1f395bbd5f7f27a5cd9569d794d032747323bf4b1521fbe7725875a68b440abdf0559de5015baf873bb9c01cae63ecea93ad547a7397416e", "12345678901234567890"},
	{"db9981645857e59805132f7699e78bbcf39f69380a41aac8e6fa158a0593f2017ffe48764687aa855dae3023fcceefd51a1551d57730423df18503e80ba381ba", "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"},
#if PLAINTEXT_LENGTH >= 111
// password too long for this implementation
	{"7aba4411846c61b08b0f2282a8a4600232ace4dd96593c755ba9c9a4e7b780b8bdc437b5c55574b3e8409c7b511032f98ef120e25467678f0458643578eb60ff", "123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901"},
	// this one DOES NOT work for a 1 limb. Only 111 bytes max can be used, unless we do 2 sha512 limbs.
//	{"a5fa73a3c9ca13df56c2cb3ae6f2e57671239a6b461ef5021a65d08f40336bfb458ec52a3003e1004f1a40d0706c27a9f4268fa4e1479382e2053c2b5b47b9b2", "12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789"},
#endif
#ifdef DEBUG //Special test cases.
	{"12b03226a6d8be9c6e8cd5e55dc6c7920caaa39df14aab92d5e3ea9340d1c8a4d3d0b8e4314f1f6ef131ba4bf1ceb9186ab87c801af0d5c95b1befb8cedae2b9", "1234567890"},
	{"eba392e2f2094d7ffe55a23dffc29c412abd47057a0823c6c149c9c759423afde56f0eef73ade8f79bc1d16a99cbc5e4995afd8c14adb49410ecd957aecc8d02", "123456789012345678901234567890"},
	{"3a8529d8f0c7b1ad2fa54c944952829b718d5beb4ff9ba8f4a849e02fe9a272daf59ae3bd06dde6f01df863d87c8ba4ab016ac576b59a19078c26d8dbe63f79e", "1234567890123456789012345678901234567890"},
	{"49c1faba580a55d6473f427174b62d8aa68f49958d70268eb8c7f258ba5bb089b7515891079451819aa4f8bf75b784dc156e7400ab0a04dfd2b75e46ef0a943e", "12345678901234567890123456789012345678901234567890"},
	{"8c5b51368ec88e1b1c4a67aa9de0aa0919447e142a9c245d75db07bbd4d00962b19112adb9f2b52c0a7b29fe2de661a872f095b6a1670098e5c7fde4a3503896", "123456789012345678901234567890123456789012345678901"},
	{"35ea7bc1d848db0f7ff49178392bf58acfae94bf74d77ae2d7e978df52aac250ff2560f9b98dc7726f0b8e05b25e5132074b470eb461c4ebb7b4d8bf9ef0d93f", "1234567890123456789012345678901234567890123456789012345"},
#endif
	{NULL}
};
#endif

#ifdef __XSHA512_CREATE_PROPER_TESTS_ARRAY__
static struct fmt_tests sha512_common_tests_xsha512[] = {
	{"bb0489df7b073e715f19f83fd52d08ede24243554450f7159dd65c100298a5820525b55320f48182491b72b4c4ba50d7b0e281c1d98e06591a5e9c6167f42a742f0359c7", "password"},
	{"$LION$74911f723bd2f66a3255e0af4b85c639776d510b63f0b939c432ab6e082286c47586f19b4e2f3aab74229ae124ccb11e916a7a1c9b29c64bd6b0fd6cbd22e7b1f0ba1673", "hello"},
	{"$LION$5e3ab14c8bd0f210eddafbe3c57c0003147d376bf4caf75dbffa65d1891e39b82c383d19da392d3fcc64ea16bf8203b1fc3f2b14ab82c095141bb6643de507e18ebe7489", "boobies"},
	{"6e447043e0ffd398d8cadeb2b693dd3306dbe164824a31912fb38579b9c94284da8dddfde04b94f8dc03acaa88ed7acabf4d179d4a5a1ae67f9d18edd600292b3b3aa3b7", "1"},
	{"$LION$4f665a61556fc2f8eb85805fb59aff5b285f61bd3304ea88521f6a9576aa1ba0a83387206cb23db5f59b908ffdcc15dfa74a8665bdcc04afc5a4932cb1b70c328b927821", "12"},
	{"6b354a4d64903461d26cb623d077d26263a70b9b9e9bd238a7212df03e78653c0a82c2cb9eebc8abde8af5a6868f96e67d75653590b4e4c3e50c2c2dc3087fd0999a2398", "123"},
	{"$LION$4f7a5742171fa68108e0a14e9e2e5dde63cb91edf1ebf97373776eb89ad1416a9daa52128d66adb550a0efe22772738af90a63d86336995ecbb78072f8b01272bdc5a4af", "1234"},
	{"3553414d79fe726061ed53f6733fbd114e50bb7b671405db7a438ce2278b03631ea892bc66e80f8e81c0848cfef66d0d90d8d81ccd2a794258cf8c156630fd6b1e34cb54", "12345"},
	{"$LION$7130783388b31fabc563ba8054106afd4cfa7d479d3747e6d6db454987015625c8ab912813e3d6e8ac35a7e00fa05cfbbaf64e7629e4d03f87a3ec61073daef2f8ade82b", "123456"},
	{"45736e346f878c0017207c3398f8abd6b3a01550518f8f9d3b9250077d5a519c2bacf8d69f8d17ca479f3ada7759fa5005a387256ae9dcccf78ae7630ec344458ed5f123", "1234567"},
	{"$LION$4b43646117eb0c976059469175e7c020b5668deee5a3fb50afd9b06f5e4a6e01935a38fa0d77990f5ddb663df3a4c9e1d73cec03af1e6f8c8896b7ec01863298219c2655", "12345678"},
	{"5656764a7760e50b1057b3afdb98c02bd2e7919c244ec2fa791768d4fd6a5ecffb5d16241f34705156a49ec2a33b2e0ed3a1aa2ff744af4c086adbdcbe112720ed388474", "123456789"},
	{"$LION$52396836b22e1966f14f090fc611ed99916992d6e03bffa86fe77a4993bd0952e706c13acc34edefa97a1dee885c149b34c27b8b4f5b3b611d9e739833b21c5cf772e9e7", "1234567890"},
	{"66726849de71b8757c15933a6c1dda60e8253e649bef07b93199ccafe1897186ed0ad448ddbfdbe86681e70c0d1a427eaf3b269a7b78dcc4fa67c89e6273b062b29b0410", "12345678901"},
	{"$LION$51334c32935aaa987ca03d0085c566e57b50cd5277834cd54995b4bc7255b798303b7e000c8b0d59d1ab15ce895c331c0c9a3fe021f5485dbf5955835ecd02de169f39cd", "123456789012"},
	{"4d7677548a5ab1517073cd317db2639c6f7f9de5b4e5246ef7805fc0619c474ed82e3fa88c99bf3dc7f9f670ff70d9a23af429181cc2c79ff38f5cad1937e4fc02db1e5a", "1234567890123"},
	{NULL}
};
#endif
#endif
